%% Introducción



\documentclass[serif, aspectratio=169]{beamer}
\usepackage{bookmark}
%\documentclass[serif]{beamer}  % for 4:3 ratio
\usepackage[T1]{fontenc} 
\usepackage{fourier}
\usepackage{hyperref}
\usepackage{bookmark}
\usepackage{latexsym,amsmath,xcolor,multicol,booktabs,calligra}
\usepackage{graphicx,listings,stackengine}
\usepackage[spanish]{babel}
%\setbeameroption{show notes on second screen=right} % Para la versión final desactivo esto.

\author{Alberto Daniel Lange}
\vspace{-3mm}
\title{Sistema de comunicaciones seguras \\ con segmentación virtual de dominios}
\subtitle{\small Avance de proyecto}
\institute{
    Dirección: Juan Ignacio Vaccarezza \\
    Codirección: Santiago Pérez Ghiglia \\
    \vspace{2mm}
    Ingeniería en Telecomunicaciones \\
    Instituto Balseiro
}
\vspace{-7mm}
\date{\small 26 de febrero de 2025}
\usepackage{UoWstyle}

% defs
\def\cmd#1{\texttt{\color{red}\footnotesize $\backslash$#1}}
\def\env#1{\texttt{\color{blue}\footnotesize #1}}
\definecolor{deepblue}{rgb}{0,0,0.5}
\definecolor{deepred}{RGB}{153,0,0}
\definecolor{deepgreen}{rgb}{0,0.5,0}
\definecolor{halfgray}{gray}{0.55}

\lstset{
    basicstyle=\ttfamily\small,
    keywordstyle=\bfseries\color{deepblue},
    emphstyle=\ttfamily\color{deepred},   
    stringstyle=\color{deepgreen},
    numbers=left,
    numberstyle=\small\color{halfgray},
    rulesepcolor=\color{red!20!green!20!blue!20},
    frame=shadowbox,
}


\begin{document}

% INICIO
\begin{frame} % LOGOS INSTITUCIONALES
    \titlepage
    \vspace*{-0.8cm}
\begin{columns}
    \begin{column}{0.25\textwidth}
        \begin{figure}
            \centering
            \includegraphics[width=0.3\textwidth]{images/institucionales_cnea.png}
        \end{figure}
    \end{column}
    \begin{column}{0.25\textwidth}
        \begin{figure}
            \centering
            \includegraphics[width=0.3\textwidth]{images/institucionales_IB.png}
        \end{figure}
    \end{column}
    \begin{column}{0.25\textwidth}
        \begin{figure}
            \centering
            \includegraphics[width=0.5\textwidth]{images/institucionales_INVAP.png}
        \end{figure}
    \end{column}
    \begin{column}{0.25\textwidth}
        \begin{figure}
            \centering
            \includegraphics[width=0.3\textwidth]{images/institucionales_cuyo.png}
        \end{figure}
        
    \end{column}
\end{columns}
\end{frame}


\begin{frame}    
\tableofcontents[sectionstyle=show,
subsectionstyle=show/shaded/hide,
subsubsectionstyle=show/shaded/hide]
\end{frame}

\section{Introducción}

\begin{frame}{Contexto}
            \begin{figure}
                \centering
                \includegraphics[width=0.5\textwidth]{images/conops.png}
                \caption{\centering Esquema simplificado de operación del sistema.}
            \end{figure}

    \note{Antes que nada quiero dar un pantallazo general de lo que se trata este proyecto. ¿A que nos referimos con sistema de comunicaciones seguras? Se trata del desarrollo de un dispositivo encriptador destinado a asegurar las comunicaciones entre sitios, es decir, que permita establecer una red privada virtual o VPN entre estos sitios.
    En la figura se puede ver un esquema simplificado de la operación del sistema. Estos dispositivos hacen de interfaz entre dos dominios, el rojo, que contiene información no cifrada, y el negro, que es la parte externa, donde la información se encuentra cifrada.
    }
\end{frame}


\begin{frame}{Progreso alcanzado anteriormente}
    \begin{columns}
    \begin{column}{0.33\textwidth}

    \begin{itemize}
        \item Definición y validación de arquitectura lógica en laboratorio virtual.
    \end{itemize}

    \end{column}
    \begin{column}{0.7\textwidth}
    \begin{figure}
        \centering
        \includegraphics[width=0.95\textwidth]{images/gns3_2.png}
        \caption{Simulación de la propuesta de solución en GNS3.} 
    \end{figure}
    \end{column}
\end{columns}
\end{frame}

\begin{frame}{Pendientes}
    \begin{itemize}
        \item Validación del encriptador en ambiente virtualizado. 
        \item Implementación sobre hardware.
    \end{itemize}

    \note{Estos son los temas que van a ser cubiertos en esta charla.}
\end{frame}

\section{Revisión bibliográfica}

\begin{frame}{seL4}
    \begin{columns}
        \begin{column}{0.45\textwidth}
            \begin{itemize}
                \item Microkernel de código abierto.
                \item Hipervisor tipo 1.
                \item Aislamiento entre componentes garantizado.
            \end{itemize}
        \end{column}

        % verde sel4 7BB661
        % amarillo vm FFC857
        % azul vm 6FA8DC
        % gris pc B4C5D9
        % gris switch E7E7E7

        \begin{column}{0.6\textwidth}
            \begin{figure}
                \centering
                \includegraphics[width=0.75\textwidth]{../../Tesis/figs/2_sel4arch.png}
                \caption{\centering Esquema de entorno virtualizado usando seL4 como hipervisor.} 
            \end{figure}
        \end{column}
    \end{columns}
    
    \note{seL4 es un microkernel diseñado para ser seguro, eficiente y confiable. Se ejecuta directamente sobre hardware con capacidad de funcionar como hipervisor de tipo 1. Su característica más importante es la verificación formal de su funcionamiento, lo que significa que se demostró matemáticamente que su implementación cumple con sus especificaciones de diseño. Una de estas especificaciones críticas es la aislación entre componentes, fundamental para nuestro sistema de segmentación de dominios.}
\end{frame}

\begin{frame}{CAmkES}
    \begin{columns}
        \begin{column}{0.5\textwidth}
            \begin{itemize}
                \item \textbf{C}omponent \textbf{A}rchitecture for \textbf{m}icro\textbf{k}ernel-based \textbf{E}mbedded \textbf{S}ystems.
                \item Framework de desarrollo para seL4.
                \item Comunicación mediante interfaces bien definidas.
            \end{itemize}
        \end{column}

        \begin{column}{0.5\textwidth}
            \begin{figure}
                \centering
                \includegraphics[width=0.7\textwidth]{images/camkes.png}
                \caption{\centering Ejemplo de componentes e interfaces en CAmkES.} 
            \end{figure}
        \end{column}
    \end{columns}
    
    \note{CAmkES es un framework que simplifica el desarrollo de sistemas sobre seL4. Permite diseñar aplicaciones como un conjunto de componentes que se comunican a través de interfaces bien definidas. Esto es especialmente útil para nuestro proyecto ya que cada máquina virtual puede ser vista como un componente independiente con interfaces de comunicación controladas, lo que facilita la implementación de la segmentación de dominios.}
\end{frame}

\begin{frame}{Modelos ejemplo en CAmkES}
    \begin{columns}[T]
        \begin{column}{0.43\textwidth}
            \textbf{minimal\_64}
            \begin{itemize}
                \item Implementación mínima de una VM para arquitectura x86\_64.
                \item Punto de partida para el desarrollo.
            \end{itemize}
        \end{column}

        \begin{column}{0.43\textwidth}
            \textbf{zmq\_samples}
            \begin{itemize}
                \item Ejemplo de comunicación entre tres VMs usando ZeroMQ.
                \item Modelo base para la implementación del encriptador.
            \end{itemize}
        \end{column}
    \end{columns}
    
\end{frame}

\section{Desarrollo}

\begin{frame}{Estrategia de modelos en entornos virtualizados}
       \textbf{¿Qué?} 
       \begin{itemize}
        \item Realizar modelos que validen progresivamente los componentes desarrollados.
       \end{itemize}
       
       \vspace*{0.5cm}
       \textbf{¿Para qué?} 
       \begin{itemize}
        \item Ligar problemas concretos a cada modelo y resolverlos de forma independiente.
        \item Implementar un encriptador funcional en un entorno virtualizado como paso previo a trabajar con hardware.
       \end{itemize}
       
\end{frame}

\begin{frame}
    \begin{figure}
        \centering
        \includegraphics[width=0.8\textwidth]{../../Tesis/figs/3_modelosall.png}
        \caption{Modelos en entornos virtualizados.}
    \end{figure}
\end{frame}

\begin{frame}{Modelo virtualizado}
    \begin{columns}
        \begin{column}{0.35\textwidth}
            \begin{itemize}
                \item Validar la arquitectura lógica del encriptador.
                \item Funcionalidad \textit{split-tunneling}.
            \end{itemize}
        \end{column}
        \begin{column}{0.6\textwidth}
            \begin{figure}
                \centering
                \includegraphics[width=\textwidth]{images/gns3_2.png}
                \caption{Simulación de la arquitectura lógica en GNS3.}
            \end{figure}
        \end{column}
    \end{columns}
\end{frame}

% \begin{frame}{Modelo II: comunicando sitios con WireGuard}
%     \begin{columns}
%         \begin{column}{0.35\textwidth}
%             \begin{itemize}
%                 \item Validación del kernel Linux 4.9 con soporte para WireGuard.
%                 \item Obtener parámetros PCI necesarios para el passthrough de la interfaz de red.
%             \end{itemize}
%         \end{column}
%         \begin{column}{0.6\textwidth}
%             \begin{figure}
%                 \centering
%                 \includegraphics[width=\textwidth]{images/gns3_1.png}
%                 \caption{Arquitectura lógica en GNS3.}
%             \end{figure}
%         \end{column}
%     \end{columns}
% \end{frame}

% \begin{frame}{Modelo II: comunicando sitios con WireGuard - Sistema operativo VMs}
%         \begin{itemize}
%             \item Buildroot como sistema de archivos.
%             \item Kernel Linux 4.9.337.
%             \item Parche de compatibilidad WireGuard con Linux $\leq$ 5.6.
%         \end{itemize}
% \end{frame}

\begin{frame}{Modelo emulado}
    \begin{columns}
        \begin{column}{0.4\textwidth}
            \begin{itemize}
                \item Validación del passthrough de hardware y la compatibilidad del kernel Linux 4.9 con seL4.
            \end{itemize}
        \end{column}
        \begin{column}{0.6\textwidth}
            \begin{figure}
                \centering
                \includegraphics[width=0.95\textwidth]{../../Tesis/figs/3_modelemulated.png}
                \caption{Esquema del modelo emulado.}
            \end{figure}
        \end{column}
    \end{columns}

    \note{Acá contar como se obtienen los parámetros PCI necesarios para el passthrough de la interfaz de red. Y como se configura el kernel Linux 4.9 para que sea compatible con seL4. Buildroot wireguard etc}
\end{frame}

\begin{frame}{Modelo emulado: passthrough de hardware}
    CAmkES actúa de interfaz para la configuración del passthrough de dispositivos PCI a una VM a través de los Base Address Registers (BARs) e interrupciones.
    
    \vspace*{1cm}

     \begin{block}{\small Ejemplo de configuración en CAmkES:}
          \texttt{vm0.vm\_ioports = [start, end];} \\
          \texttt{vm0.pci\_devices = [bus, device, function, memory];} \\
          \texttt{vm0.vm\_irqs = [source, dest];}
     \end{block}
\end{frame}

\begin{frame}{Modelo emulado: gestión de memoria VMs}
    \texttt{simple\_untypedN\_pool:} prealocación de memoria para las VMs. \\
    \texttt{heap\_size:} tamaño del heap del VMM. \\
    \texttt{guest\_ram\_mb:} tamaño de la RAM asignada a cada VM.
\end{frame}

\begin{frame}{Modelo de hardware}
    \begin{columns}
        \begin{column}{0.4\textwidth}
            \begin{itemize}
                \item Solución completa como paso previo a la implementación en hardware.
        
            \end{itemize}
        \end{column}
        \begin{column}{0.6\textwidth}
            \begin{figure}
                \centering
                \includegraphics[width=\textwidth]{../../Tesis/figs/3_model4.png}
                \caption{Esquema del modelo de hardware.}
            \end{figure}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Modelo de hardware: comunicación entre VMs}
\textbf{¿Cómo funciona?}
\begin{block}{\small Virtio-Net en VM}
\begin{itemize}
    \item El host implementa un dispositivo PCI virtual (virtio-net).
    \item La VM encuentra este dispositivo y carga el driver correspondiente.
    \item En la transmisión, la VM escribe los datos a enviar en un buffer asociado a una cola del hipervisor. El VMM notifica al host que hay datos listos en la cola (virtqueue).
\end{itemize}
\end{block}

\begin{block}{\small Virtio-Net en host}
\begin{itemize}
    \item El host lee el paquete en la virtqueue y lo copia a un buffer dentro del espacio de memoria de la VM destino.
    \item El host inyecta una interrupción en la VM destino para notificarle que hay datos disponibles.
\end{itemize}
\end{block}

\end{frame}

% \begin{frame}{Modelo de hardware: comunicación entre VMs}
%     \textbf{Desafíos:}
%     \begin{itemize}
%         \item La implementación actual requiere de 7 map/unmap de memoria por paquete.
%     \end{itemize}

% \end{frame}

\begin{frame}{Modelo de hardware: integración}
% Mostrar ping entre PCs
\begin{figure}
    \centering
    \includegraphics[width=0.8\textwidth]{images/pingAB.png}
    \caption{Comunicación entre PCs en nodos distintos.}
\end{figure}
\end{frame}

\begin{frame}{Modelo de hardware: integración}
% Mostrar ping entre PCs
\begin{figure}
    \centering
    \includegraphics[width=0.8\textwidth]{images/pinginternet.png}
    \caption{Ping de un nodo a internet.}
\end{figure}
\end{frame}

% Slide 1: Características del hardware
\begin{frame}{Implementación en hardware}
\begin{columns}
    \begin{column}{0.5\textwidth}
        \begin{figure}
            \centering
            \includegraphics[width=0.8\textwidth]{../../Tesis/figs/4_hardware.png}
            \caption{SuperMicro SYS-E300-9D.} 
        \end{figure}
    \end{column}
    \begin{column}{0.4\textwidth}
        \textbf{Características:}
        \begin{itemize}
            \item CPU: Intel Xeon D-2123IT (4C/8T)
            \item RAM: 32 GB DDR4
            \item 4x NIC Intel i210 1GbE \\
            2x NIC Intel X553 10GbE
            \item Soporte para virtualización (VT-x, VT-d)
        \end{itemize}
    \end{column}
\end{columns}
\end{frame}

% Slide 2: Desafíos
\begin{frame}{Implementación en hardware: desafíos}
\begin{columns}
    \begin{column}{0.5\textwidth}
        \begin{figure}
            \centering
            \includegraphics[width=0.8\textwidth]{../../Tesis/figs/4_hardware.png}
            \caption{SuperMicro SYS-E300-9D.} 
        \end{figure}
    \end{column}
    \begin{column}{0.4\textwidth}
        \textbf{Desafíos:}
        \begin{itemize}
            \item[\space \textcolor{green}{\checkmark}] Redirección de consola.
            \item[{\color{red}\texttimes}] Passthrough de controlador Ethernet.
            \item[{\color{red}\texttimes}] Throughput entre VMs.
        \end{itemize}
    \end{column}
\end{columns}
\end{frame}

\begin{frame}{Implementación en hardware: throughput entre VMs}
\begin{columns}
    \begin{column}{0.51\textwidth}
    \begin{itemize}
         \item La implementación actual requiere de 7 mapeos de memoria por paquete, lo que limita drásticamente el throughput.
    \end{itemize}

    \end{column}
    \begin{column}{0.50\textwidth}
        \begin{figure}
            \centering
            \includegraphics[width=0.75\textwidth]{example-image}
            \caption{Throughput medido entre VMs.}
        \end{figure}
    \end{column}
\end{columns}
\end{frame}


\begin{frame}{Implementación en hardware: throughput entre VMs}
\begin{columns}[T]
    \begin{column}{0.50\textwidth}
    Existen alternativas para mejorar el rendimiento:
    \begin{itemize}
        \item Translation Vspace.
        \item Optimización de copias en memoria.
    \end{itemize}

    \end{column}
    \begin{column}{0.45\textwidth}
        \begin{figure}
            \centering
            \includegraphics[width=0.85\textwidth]{images/throughput_improve.png}
            \caption{\centering Optimizaciones logradas sobre el throughput entre VMs. \hspace{4cm} \footnotesize{Fuente: seL4 Summit 2023.}}
        \end{figure}
    \end{column}
\end{columns}
\end{frame}

\begin{frame}{Implementación en hardware: throughput entre VMs}
\begin{columns}[T]
    \begin{column}{0.50\textwidth}
    Existen alternativas para mejorar el rendimiento:
    \begin{itemize}
        \item Translation Vspace.
        \item Optimización de copias en memoria.
    \end{itemize}
    \begin{figure}
        \centering
        \includegraphics[width=0.35\textwidth]{images/bug.png}
    \end{figure}

    \end{column}
    \begin{column}{0.45\textwidth}
        \begin{figure}
            \centering
            \includegraphics[width=0.85\textwidth]{images/throughput_improve.png}
            \caption{\centering Optimizaciones logradas sobre el throughput entre VMs. \hspace{4cm} \footnotesize{Fuente: seL4 Summit 2023.}}
        \end{figure}
    \end{column}
\end{columns}
\end{frame}


\section{Conclusiones}
\begin{frame}{Resumen}
    \begin{itemize}
        \item Introducción a los modelos de trabajo utilizados. 
        \item Validación del encriptador en un entorno virtualizado.
        \item Avances en la implementación sobre hardware.
    \end{itemize}

    \note{En resumen, hemos avanzado significativamente en el desarrollo de un sistema de comunicaciones seguras con segmentación virtual de dominios. Hemos validado la arquitectura lógica y la funcionalidad de los modelos, lo que nos permite avanzar hacia la implementación en hardware y las pruebas de integración.}
\end{frame}

\begin{frame}{Trabajo a futuro}
    \begin{itemize}
        \item Resolver desafíos pendientes en la implementación de hardware.
        \item Documentar y presentar la solución final.
    \end{itemize}

    \note{En resumen, hemos avanzado significativamente en el desarrollo de un sistema de comunicaciones seguras con segmentación virtual de dominios. Hemos validado la arquitectura lógica y la funcionalidad de los modelos, lo que nos permite avanzar hacia la implementación en hardware y las pruebas de integración.}
\end{frame}


\begin{frame}
    \begin{center}
        \Huge ¡Muchas gracias! \\
        \Huge ¿Preguntas?
    \end{center}
\end{frame}

% FIN

\end{document}